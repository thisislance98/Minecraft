{
  "framework": "voxel-game",
  "title": "Fear Spell Wand Template",
  "content": "# Fear Spell Wand Template - Makes Creatures Flee\n\nThis template shows how to create a wand that:\n1. Emits a fear wave/aura around the player\n2. Makes ALL creatures in range flee for 30 seconds\n3. Includes spooky visual effects (dark wave, skull particles)\n\n## PART 1: THE FEAR WAND ITEM CLASS\n\n```javascript\nclass FearWandItem extends Item {\n    constructor() {\n        super('fear_wand', 'Fear Wand');\n        this.maxStack = 1;\n        this.isTool = true;\n        this.cooldown = 5000;       // 5 second cooldown (powerful spell)\n        this.lastUseTime = 0;\n        this.fearRadius = 20;       // Affects creatures within 20 blocks\n        this.fearDuration = 30.0;   // Creatures flee for 30 seconds\n\n        // INVENTORY ICON - Spooky skull wand\n        this.icon = `<svg viewBox=\"0 0 24 24\">\n            <rect x=\"10\" y=\"12\" width=\"4\" height=\"10\" fill=\"#2D1B4E\" rx=\"1\"/>\n            <circle cx=\"12\" cy=\"7\" r=\"5\" fill=\"#E8E8E8\"/>\n            <circle cx=\"10\" cy=\"6\" r=\"1.2\" fill=\"#1a1a1a\"/>\n            <circle cx=\"14\" cy=\"6\" r=\"1.2\" fill=\"#1a1a1a\"/>\n            <path d=\"M10,9 Q12,11 14,9\" stroke=\"#1a1a1a\" fill=\"none\" stroke-width=\"0.8\"/>\n            <path d=\"M7,7 L5,5 M17,7 L19,5\" stroke=\"#9B59B6\" stroke-width=\"0.5\"/>\n        </svg>`;\n    }\n\n    onUseDown(game, player) {\n        const now = Date.now();\n        if (now - this.lastUseTime < this.cooldown) return false;\n        this.lastUseTime = now;\n\n        // Create the fear wave effect\n        const fearWave = new FearWaveEffect(game, player.position.clone(), this.fearRadius, this.fearDuration);\n        game.projectiles = game.projectiles || [];\n        game.projectiles.push(fearWave);\n        game.scene.add(fearWave.mesh);\n\n        // Apply fear to all creatures in range\n        this.applyFearToCreatures(game, player);\n\n        if (player.swingArm) player.swingArm();\n        return true;\n    }\n\n    onPrimaryDown(game, player) {\n        return this.onUseDown(game, player);\n    }\n\n    applyFearToCreatures(game, player) {\n        if (!game.animals) return;\n\n        const playerPos = player.position.clone();\n        let affectedCount = 0;\n\n        for (const animal of game.animals) {\n            if (!animal.position) continue;\n            if (animal === game.merlin) continue; // Don't scare Merlin!\n            if (animal.isDead || animal.isDying) continue;\n\n            const dist = animal.position.distanceTo(playerPos);\n            if (dist <= this.fearRadius) {\n                // Apply extended fear effect\n                this.applyFearEffect(animal, player, this.fearDuration);\n                affectedCount++;\n\n                // Visual indicator on each affected creature\n                this.spawnFearParticlesOnCreature(game, animal);\n            }\n        }\n\n        console.log(`[FearWand] Affected ${affectedCount} creatures for ${this.fearDuration}s`);\n    }\n\n    applyFearEffect(animal, player, duration) {\n        // Set the animal to flee state\n        animal.state = 'flee';\n        animal.stateTimer = duration;  // 30 seconds of fleeing!\n        animal.isMoving = true;\n        animal.fleeTarget = player;\n\n        // Store original flee settings to restore later\n        if (!animal._originalFleeOnProximity) {\n            animal._originalFleeOnProximity = animal.fleeOnProximity;\n            animal._originalFleeRange = animal.fleeRange;\n        }\n\n        // Temporarily boost flee behavior\n        animal.fleeOnProximity = true;\n        animal.fleeRange = 50; // Extended flee range while feared\n\n        // Set up restoration after fear ends\n        setTimeout(() => {\n            if (animal && !animal.isDead) {\n                // Restore original settings\n                if (animal._originalFleeOnProximity !== undefined) {\n                    animal.fleeOnProximity = animal._originalFleeOnProximity;\n                    animal.fleeRange = animal._originalFleeRange;\n                    delete animal._originalFleeOnProximity;\n                    delete animal._originalFleeRange;\n                }\n            }\n        }, duration * 1000);\n    }\n\n    spawnFearParticlesOnCreature(game, animal) {\n        if (!game.worldParticleSystem || !game.worldParticleSystem.spawn) return;\n\n        // Dark purple/black fear particles around the creature\n        const colors = [0x4B0082, 0x2D1B4E, 0x1a1a1a, 0x9B59B6];\n        for (let i = 0; i < 8; i++) {\n            const vel = new window.THREE.Vector3(\n                (Math.random() - 0.5) * 2,\n                Math.random() * 3 + 1,\n                (Math.random() - 0.5) * 2\n            );\n            game.worldParticleSystem.spawn({\n                position: animal.position.clone().add(new window.THREE.Vector3(0, 1, 0)),\n                velocity: vel,\n                color: colors[Math.floor(Math.random() * colors.length)],\n                life: 1.0 + Math.random() * 0.5\n            });\n        }\n    }\n\n    // 3D model shown in player's hand - Skull-topped wand\n    getMesh() {\n        const group = new window.THREE.Group();\n\n        // Dark handle\n        const handle = new window.THREE.Mesh(\n            new window.THREE.CylinderGeometry(0.03, 0.05, 0.5, 8),\n            new window.THREE.MeshLambertMaterial({ color: 0x2D1B4E })\n        );\n        handle.position.y = -0.1;\n        group.add(handle);\n\n        // Skull head (simplified)\n        const skull = new window.THREE.Mesh(\n            new window.THREE.SphereGeometry(0.1, 8, 8),\n            new window.THREE.MeshStandardMaterial({\n                color: 0xE8E8E8,\n                emissive: 0x4B0082,\n                emissiveIntensity: 0.2\n            })\n        );\n        skull.position.y = 0.2;\n        skull.scale.set(1, 0.9, 0.8);\n        group.add(skull);\n\n        // Eye sockets (dark spheres)\n        const eyeMat = new window.THREE.MeshBasicMaterial({ color: 0x000000 });\n        const leftEye = new window.THREE.Mesh(new window.THREE.SphereGeometry(0.025, 6, 6), eyeMat);\n        leftEye.position.set(-0.035, 0.22, 0.07);\n        group.add(leftEye);\n\n        const rightEye = new window.THREE.Mesh(new window.THREE.SphereGeometry(0.025, 6, 6), eyeMat);\n        rightEye.position.set(0.035, 0.22, 0.07);\n        group.add(rightEye);\n\n        return group;\n    }\n}\n```\n\n## PART 2: FEAR WAVE VISUAL EFFECT\n\nExpanding dark ring that pulses outward from the player:\n\n```javascript\nclass FearWaveEffect {\n    constructor(game, position, maxRadius, fearDuration) {\n        this.game = game;\n        this.position = position.clone();\n        this.maxRadius = maxRadius;\n        this.fearDuration = fearDuration;\n        this.lifeTime = 0;\n        this.maxLifeTime = 1.5; // Visual effect lasts 1.5 seconds\n        this.currentRadius = 0;\n\n        // Create the expanding ring mesh\n        this.mesh = this.createWaveMesh();\n        this.mesh.position.copy(this.position);\n        this.mesh.position.y += 0.5; // Slightly above ground\n\n        // Spawn initial burst particles\n        this.spawnBurstParticles();\n    }\n\n    createWaveMesh() {\n        const group = new window.THREE.Group();\n\n        // Main dark ring\n        const ringGeo = new window.THREE.RingGeometry(0.5, 1.5, 32);\n        const ringMat = new window.THREE.MeshBasicMaterial({\n            color: 0x4B0082,\n            transparent: true,\n            opacity: 0.7,\n            side: window.THREE.DoubleSide\n        });\n        this.ring = new window.THREE.Mesh(ringGeo, ringMat);\n        this.ring.rotation.x = -Math.PI / 2; // Lay flat\n        group.add(this.ring);\n\n        // Secondary inner ring (lighter purple)\n        const innerRingGeo = new window.THREE.RingGeometry(0.2, 0.8, 32);\n        const innerRingMat = new window.THREE.MeshBasicMaterial({\n            color: 0x9B59B6,\n            transparent: true,\n            opacity: 0.5,\n            side: window.THREE.DoubleSide\n        });\n        this.innerRing = new window.THREE.Mesh(innerRingGeo, innerRingMat);\n        this.innerRing.rotation.x = -Math.PI / 2;\n        this.innerRing.position.y = 0.1;\n        group.add(this.innerRing);\n\n        // Dark vertical pillar of energy\n        const pillarGeo = new window.THREE.CylinderGeometry(0.3, 0.3, 3, 8, 1, true);\n        const pillarMat = new window.THREE.MeshBasicMaterial({\n            color: 0x2D1B4E,\n            transparent: true,\n            opacity: 0.4,\n            side: window.THREE.DoubleSide\n        });\n        this.pillar = new window.THREE.Mesh(pillarGeo, pillarMat);\n        this.pillar.position.y = 1.5;\n        group.add(this.pillar);\n\n        return group;\n    }\n\n    spawnBurstParticles() {\n        if (!this.game.worldParticleSystem || !this.game.worldParticleSystem.spawn) return;\n\n        // Outward burst of dark particles\n        const colors = [0x4B0082, 0x2D1B4E, 0x1a1a1a, 0x9B59B6, 0x6B3FA0];\n        for (let i = 0; i < 40; i++) {\n            const angle = (i / 40) * Math.PI * 2;\n            const speed = 5 + Math.random() * 5;\n            const vel = new window.THREE.Vector3(\n                Math.cos(angle) * speed,\n                Math.random() * 3,\n                Math.sin(angle) * speed\n            );\n            this.game.worldParticleSystem.spawn({\n                position: this.position.clone().add(new window.THREE.Vector3(0, 1, 0)),\n                velocity: vel,\n                color: colors[Math.floor(Math.random() * colors.length)],\n                life: 0.8 + Math.random() * 0.5\n            });\n        }\n\n        // Upward spiral particles\n        for (let i = 0; i < 20; i++) {\n            const vel = new window.THREE.Vector3(\n                (Math.random() - 0.5) * 2,\n                5 + Math.random() * 5,\n                (Math.random() - 0.5) * 2\n            );\n            this.game.worldParticleSystem.spawn({\n                position: this.position.clone(),\n                velocity: vel,\n                color: colors[Math.floor(Math.random() * colors.length)],\n                life: 1.0 + Math.random() * 0.5\n            });\n        }\n    }\n\n    update(dt) {\n        this.lifeTime += dt;\n        if (this.lifeTime > this.maxLifeTime) {\n            this.dispose();\n            return false;\n        }\n\n        const progress = this.lifeTime / this.maxLifeTime;\n\n        // Expand the rings outward\n        this.currentRadius = progress * this.maxRadius;\n        const scale = 1 + progress * (this.maxRadius / 2);\n        this.ring.scale.set(scale, scale, 1);\n        this.innerRing.scale.set(scale * 0.8, scale * 0.8, 1);\n\n        // Fade out\n        const fadeOut = 1 - progress;\n        this.ring.material.opacity = 0.7 * fadeOut;\n        this.innerRing.material.opacity = 0.5 * fadeOut;\n        this.pillar.material.opacity = 0.4 * fadeOut;\n\n        // Pillar rises and expands\n        this.pillar.scale.y = 1 + progress * 2;\n        this.pillar.scale.x = 1 + progress * 3;\n        this.pillar.scale.z = 1 + progress * 3;\n        this.pillar.position.y = 1.5 + progress * 2;\n\n        // Spawn trailing particles periodically\n        if (Math.random() < 0.3) {\n            this.spawnTrailParticle();\n        }\n\n        return true;\n    }\n\n    spawnTrailParticle() {\n        if (!this.game.worldParticleSystem || !this.game.worldParticleSystem.spawn) return;\n\n        const angle = Math.random() * Math.PI * 2;\n        const radius = this.currentRadius * Math.random();\n        const pos = this.position.clone().add(new window.THREE.Vector3(\n            Math.cos(angle) * radius,\n            Math.random() * 2,\n            Math.sin(angle) * radius\n        ));\n\n        this.game.worldParticleSystem.spawn({\n            position: pos,\n            velocity: new window.THREE.Vector3(0, 2, 0),\n            color: 0x4B0082,\n            life: 0.5\n        });\n    }\n\n    dispose() {\n        this.game.scene.remove(this.mesh);\n        this.mesh.traverse(child => {\n            if (child.geometry) child.geometry.dispose();\n            if (child.material) child.material.dispose();\n        });\n    }\n}\n```\n\n## USAGE NOTES\n\n- Register the item: `game.dynamicItemRegistry.registerItem('fear_wand', FearWandItem);`\n- Give to player: `game.giveItem('fear_wand');`\n- The fear effect:\n  * Sets `animal.state = 'flee'` for 30 seconds\n  * Sets `animal.fleeTarget = player`\n  * Temporarily boosts `fleeRange` to 50 blocks\n  * Original flee settings restore after duration\n- Works on all animals EXCEPT Merlin\n- 5 second cooldown between uses",
  "tags": [
    "wand",
    "fear",
    "flee",
    "scare",
    "repel",
    "creature",
    "animal",
    "spell",
    "magic",
    "aura",
    "wave",
    "effect",
    "crowd",
    "control",
    "run",
    "away",
    "escape",
    "duration",
    "timed",
    "status",
    "debuff",
    "template"
  ],
  "verified": true,
  "verificationProof": "Template follows established patterns from Wand Item Projectile Template and Animal.js flee behavior",
  "id": "voxel-game-1769372381336-4nvnuq4ol",
  "created": "2026-01-25T20:19:41.336Z",
  "updated": "2026-01-25T20:19:41.336Z"
}